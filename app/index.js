/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "./main.js":
/*!*****************!*\
  !*** ./main.js ***!
  \*****************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _scripts_core_toolbox_manager_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./scripts/core/toolbox/manager.js */ \"./scripts/core/toolbox/manager.js\");\n/* harmony import */ var _scripts_core_canvas_layer_manager_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./scripts/core/canvas/layer/manager.js */ \"./scripts/core/canvas/layer/manager.js\");\n/* harmony import */ var _scripts_core_app_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./scripts/core/app.js */ \"./scripts/core/app.js\");\n\r\n\r\n\r\n\r\n\r\nif (\"serviceWorker\" in navigator) {\r\n    window.addEventListener(\"load\", function () {\r\n        navigator.serviceWorker.register(\"service-worker.js\").then(function (registration) {\r\n            console.log(\"ServiceWorker registration successful with scope: \", registration.scope);\r\n        }, function (err) {\r\n            console.log(\"ServiceWorker registration failed: \", err);\r\n        });\r\n    });\r\n}\r\n\r\n\r\nCanvasRenderingContext2D.prototype.circle = function (x, y, color = 'yellow', text = '', radius = 2) {\r\n    this.save()\r\n    const c = new Path2D();\r\n    this.fillStyle = color;\r\n    c.arc(x, y, radius, 0, Math.PI * 2);\r\n    this.fill(c);\r\n    this.fillText(text, x, y - 10);\r\n    this.restore();\r\n}\r\nCanvasRenderingContext2D.prototype.line = function (points, color = 'blue', radius = 4) {\r\n    this.save()\r\n    const c = new Path2D();\r\n    this.strokeStyle = color;\r\n    points.forEach(({ x, y }, i) => {\r\n        if (i) {\r\n            c.lineTo(x, y);\r\n            console.log('line');\r\n        } else {\r\n            c.moveTo(x, y);\r\n            console.log('move')\r\n        }\r\n    });\r\n    this.stroke(c);\r\n    this.restore();\r\n}\r\nCanvasRenderingContext2D.prototype.mark = function (x, y, text, color = 'yellow', radius = 4) {\r\n    this.save()\r\n    this.fillStyle = color;\r\n    this.fillRect(x - radius / 2, y - radius / 2, radius, radius)\r\n    this.fillText(text, x, y);\r\n    this.restore();\r\n}\r\n\r\n// Prevent right-click context menu\r\n// window.addEventListener(\"contextmenu\", function (e) {\r\n//     e.preventDefault();\r\n// }, false);\r\n\r\n_scripts_core_toolbox_manager_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].selectTool('P-pen');\r\n_scripts_core_canvas_layer_manager_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].createLayer();\r\n_scripts_core_app_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"].initDefaultKeyBind();\r\n// Keybinding\r\n\n\n//# sourceURL=webpack://quanvas/./main.js?\n}");

/***/ }),

/***/ "./node_modules/uuid/dist/native.js":
/*!******************************************!*\
  !*** ./node_modules/uuid/dist/native.js ***!
  \******************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\nconst randomUUID = typeof crypto !== 'undefined' && crypto.randomUUID && crypto.randomUUID.bind(crypto);\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({ randomUUID });\n\n\n//# sourceURL=webpack://quanvas/./node_modules/uuid/dist/native.js?\n}");

/***/ }),

/***/ "./node_modules/uuid/dist/regex.js":
/*!*****************************************!*\
  !*** ./node_modules/uuid/dist/regex.js ***!
  \*****************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i);\n\n\n//# sourceURL=webpack://quanvas/./node_modules/uuid/dist/regex.js?\n}");

/***/ }),

/***/ "./node_modules/uuid/dist/rng.js":
/*!***************************************!*\
  !*** ./node_modules/uuid/dist/rng.js ***!
  \***************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ rng)\n/* harmony export */ });\nlet getRandomValues;\nconst rnds8 = new Uint8Array(16);\nfunction rng() {\n    if (!getRandomValues) {\n        if (typeof crypto === 'undefined' || !crypto.getRandomValues) {\n            throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n        }\n        getRandomValues = crypto.getRandomValues.bind(crypto);\n    }\n    return getRandomValues(rnds8);\n}\n\n\n//# sourceURL=webpack://quanvas/./node_modules/uuid/dist/rng.js?\n}");

/***/ }),

/***/ "./node_modules/uuid/dist/stringify.js":
/*!*********************************************!*\
  !*** ./node_modules/uuid/dist/stringify.js ***!
  \*********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   unsafeStringify: () => (/* binding */ unsafeStringify)\n/* harmony export */ });\n/* harmony import */ var _validate_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./validate.js */ \"./node_modules/uuid/dist/validate.js\");\n\nconst byteToHex = [];\nfor (let i = 0; i < 256; ++i) {\n    byteToHex.push((i + 0x100).toString(16).slice(1));\n}\nfunction unsafeStringify(arr, offset = 0) {\n    return (byteToHex[arr[offset + 0]] +\n        byteToHex[arr[offset + 1]] +\n        byteToHex[arr[offset + 2]] +\n        byteToHex[arr[offset + 3]] +\n        '-' +\n        byteToHex[arr[offset + 4]] +\n        byteToHex[arr[offset + 5]] +\n        '-' +\n        byteToHex[arr[offset + 6]] +\n        byteToHex[arr[offset + 7]] +\n        '-' +\n        byteToHex[arr[offset + 8]] +\n        byteToHex[arr[offset + 9]] +\n        '-' +\n        byteToHex[arr[offset + 10]] +\n        byteToHex[arr[offset + 11]] +\n        byteToHex[arr[offset + 12]] +\n        byteToHex[arr[offset + 13]] +\n        byteToHex[arr[offset + 14]] +\n        byteToHex[arr[offset + 15]]).toLowerCase();\n}\nfunction stringify(arr, offset = 0) {\n    const uuid = unsafeStringify(arr, offset);\n    if (!(0,_validate_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(uuid)) {\n        throw TypeError('Stringified UUID is invalid');\n    }\n    return uuid;\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (stringify);\n\n\n//# sourceURL=webpack://quanvas/./node_modules/uuid/dist/stringify.js?\n}");

/***/ }),

/***/ "./node_modules/uuid/dist/v4.js":
/*!**************************************!*\
  !*** ./node_modules/uuid/dist/v4.js ***!
  \**************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _native_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./native.js */ \"./node_modules/uuid/dist/native.js\");\n/* harmony import */ var _rng_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./rng.js */ \"./node_modules/uuid/dist/rng.js\");\n/* harmony import */ var _stringify_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./stringify.js */ \"./node_modules/uuid/dist/stringify.js\");\n\n\n\nfunction _v4(options, buf, offset) {\n    options = options || {};\n    const rnds = options.random ?? options.rng?.() ?? (0,_rng_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])();\n    if (rnds.length < 16) {\n        throw new Error('Random bytes length must be >= 16');\n    }\n    rnds[6] = (rnds[6] & 0x0f) | 0x40;\n    rnds[8] = (rnds[8] & 0x3f) | 0x80;\n    if (buf) {\n        offset = offset || 0;\n        if (offset < 0 || offset + 16 > buf.length) {\n            throw new RangeError(`UUID byte range ${offset}:${offset + 15} is out of buffer bounds`);\n        }\n        for (let i = 0; i < 16; ++i) {\n            buf[offset + i] = rnds[i];\n        }\n        return buf;\n    }\n    return (0,_stringify_js__WEBPACK_IMPORTED_MODULE_2__.unsafeStringify)(rnds);\n}\nfunction v4(options, buf, offset) {\n    if (_native_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].randomUUID && !buf && !options) {\n        return _native_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].randomUUID();\n    }\n    return _v4(options, buf, offset);\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (v4);\n\n\n//# sourceURL=webpack://quanvas/./node_modules/uuid/dist/v4.js?\n}");

/***/ }),

/***/ "./node_modules/uuid/dist/validate.js":
/*!********************************************!*\
  !*** ./node_modules/uuid/dist/validate.js ***!
  \********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _regex_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./regex.js */ \"./node_modules/uuid/dist/regex.js\");\n\nfunction validate(uuid) {\n    return typeof uuid === 'string' && _regex_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].test(uuid);\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (validate);\n\n\n//# sourceURL=webpack://quanvas/./node_modules/uuid/dist/validate.js?\n}");

/***/ }),

/***/ "./scripts/core/app.js":
/*!*****************************!*\
  !*** ./scripts/core/app.js ***!
  \*****************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _shared_constants_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../shared/constants.js */ \"./scripts/shared/constants.js\");\n/* harmony import */ var _canvas_canvas_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./canvas/canvas.js */ \"./scripts/core/canvas/canvas.js\");\n/* harmony import */ var _toolbox_manager_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./toolbox/manager.js */ \"./scripts/core/toolbox/manager.js\");\n\r\n\r\n\r\n\r\nconst stateMenuElem = document.getElementById('state');\r\n\r\nclass APPManager {\r\n    constructor() {\r\n        this.state = {\r\n            erase: false,\r\n            fillrule: 'evenodd',\r\n            clip: false,\r\n            fill: false\r\n        }\r\n\r\n        this.keybinding = new Map();\r\n\r\n        this.#addEventListener();\r\n    }\r\n\r\n    initDefaultKeyBind() {\r\n        const defaultKeyBind = {\r\n            'p': () => _toolbox_manager_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"].selectTool('P-pen'),\r\n            'shift+p': () => _toolbox_manager_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"].selectTool('P-chalk'),\r\n            'r': () => _toolbox_manager_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"].selectTool('R-rectangle'),\r\n            'shift+r': () => _toolbox_manager_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"].selectTool('R-roundrectangle'),\r\n            'c': () => _toolbox_manager_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"].selectTool('C-circle'),\r\n            'shift+c': () => _toolbox_manager_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"].selectTool('C-ellipse'),\r\n            'l': () => _toolbox_manager_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"].selectTool('L-line'),\r\n            'shift+l': () => _toolbox_manager_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"].selectTool('L-arcto'),\r\n            'k': () => _toolbox_manager_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"].selectTool('K-quadratic'),\r\n            'shift+k': () => _toolbox_manager_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"].selectTool('K-bezier'),\r\n            'e': () => this.toggleState('erase'),\r\n            'f': () => this.toggleState('fill'),\r\n            'ctrl+shift+c': () => this.toggleState('clip'),\r\n            'escape': () => _canvas_canvas_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].releasePath(),\r\n        }\r\n\r\n        Object.entries(defaultKeyBind).forEach(([id, cb]) => {\r\n            this.addKeyBind(id, cb);\r\n        })\r\n    }\r\n\r\n\r\n    #addEventListener() {\r\n        stateMenuElem.addEventListener('click', e => {\r\n            const elem = e.target;\r\n            this.toggleState(elem.id);\r\n        })\r\n\r\n        addEventListener('keydown', (e) => {\r\n            e.preventDefault();\r\n            let keyBind = '';\r\n\r\n            if (e.ctrlKey) keyBind += 'ctrl+';\r\n            if (e.shiftKey) keyBind += 'shift+';\r\n            if (e.altKey) keyBind += 'alt+'\r\n            keyBind += e.key;\r\n\r\n            this.keybinding.get(keyBind.toLowerCase())?.()\r\n        })\r\n    }\r\n\r\n    addKeyBind(id, cb) {\r\n        this.keybinding.set(id, cb);\r\n    }\r\n\r\n\r\n    toggleState(id) {\r\n        _canvas_canvas_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].releasePath();\r\n        let elem = stateMenuElem.querySelector(`#${id}`);\r\n        if (!_shared_constants_js__WEBPACK_IMPORTED_MODULE_0__.TOOL_IDS.includes(id) && this.state[id] === undefined) return;\r\n\r\n        switch (id) {\r\n            case 'fillrule':\r\n                this.state[id] = this.state[id] === 'nonzero' ? 'evenodd' : 'nonzero';\r\n                if (this.state[id] === 'evenodd') elem.classList.add('selected');\r\n                else elem.classList.remove('selected');\r\n                break;\r\n\r\n            case 'fill':\r\n                console.log(this.state[id])\r\n                this.state[id] = !this.state[id];\r\n                console.log(this.state[id] === true ? './images/tools/fill.svg' : './images/tools/stroke.svg')\r\n                elem.src = this.state[id] === true ? './images/tools/fill.svg' : './images/tools/stroke.svg';\r\n                break;\r\n\r\n            default:\r\n                this.state[id] = !this.state[id];\r\n                if (this.state[id]) elem.classList.add('selected');\r\n                else elem.classList.remove('selected');\r\n                break;\r\n        }\r\n    }\r\n}\r\n\r\nconst app = new APPManager();\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (app);\n\n//# sourceURL=webpack://quanvas/./scripts/core/app.js?\n}");

/***/ }),

/***/ "./scripts/core/canvas/canvas.js":
/*!***************************************!*\
  !*** ./scripts/core/canvas/canvas.js ***!
  \***************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _shared_domElem_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../shared/domElem.js */ \"./scripts/shared/domElem.js\");\n/* harmony import */ var _utils_random_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/random.js */ \"./scripts/utils/random.js\");\n/* harmony import */ var _utils_vector_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/vector.js */ \"./scripts/utils/vector.js\");\n/* harmony import */ var _app_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../app.js */ \"./scripts/core/app.js\");\n/* harmony import */ var _toolbox_manager_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../toolbox/manager.js */ \"./scripts/core/toolbox/manager.js\");\n/* harmony import */ var _layer_manager_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./layer/manager.js */ \"./scripts/core/canvas/layer/manager.js\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass Canvas {\r\n    constructor() {\r\n        const { width, height } = _shared_domElem_js__WEBPACK_IMPORTED_MODULE_0__.rootElem.getBoundingClientRect();\r\n\r\n        this.previousPosition = { x: 0, y: 0 };\r\n        this.initialPosition = { x: 0, y: 0 };\r\n\r\n        this.canvas = document.getElementById('canvas');\r\n\r\n        this.ctx = this.canvas.getContext('2d');\r\n\r\n        this.canvas.width = width;\r\n        this.canvas.height = height;\r\n\r\n        this.path = null;\r\n\r\n        this.isDrawing = false;\r\n        this.flush = true;\r\n        this.points = [];\r\n        this.pointsCount = 0;\r\n\r\n        this.#addEventlistener();\r\n    }\r\n\r\n    createPath() {\r\n        this.path = new Path2D();\r\n    }\r\n\r\n\r\n    #addEventlistener() {\r\n        this.canvas.addEventListener('mousedown', (e) => {\r\n            if (!['L', 'K'].includes(_toolbox_manager_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"].activeToolId[0]))\r\n                this.#flushDrawing();\r\n            this.createPath();\r\n            const rect = this.canvas.getBoundingClientRect();\r\n            const x = e.clientX - rect.left;\r\n            const y = e.clientY - rect.top;\r\n\r\n            this.initialPosition.x = x;\r\n            this.initialPosition.y = y;\r\n            this.previousPosition.x = x;\r\n            this.previousPosition.y = y;\r\n\r\n            this.isDrawing = true;\r\n            console.log('mousedown')\r\n        });\r\n\r\n        this.canvas.addEventListener('mousemove', (e) => {\r\n            if (this.isDrawing) {\r\n                const rect = this.canvas.getBoundingClientRect();\r\n                const x = e.clientX - rect.left;\r\n                const y = e.clientY - rect.top;\r\n\r\n                this.draw(x, y);\r\n\r\n                this.previousPosition.x = x;\r\n                this.previousPosition.y = y;\r\n            }\r\n        });\r\n\r\n        this.canvas.addEventListener('mouseup', () => this.#flushDrawing());\r\n        // this.canvas.addEventListener('mouseleave', () => this.#flushDrawing());\r\n    }\r\n\r\n    #reset() {\r\n        this.#clear();\r\n        this.isDrawing = false;\r\n        this.path = null;\r\n        this.points = [];\r\n        this.pointsCount = 0;\r\n    }\r\n\r\n    #flushDrawing(flush) {\r\n        if (this.path === null) return;\r\n\r\n        this.draw(this.previousPosition.x, this.previousPosition.y);\r\n        this.pointsCount++;\r\n\r\n        if (['K', 'L'].includes(_toolbox_manager_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"].activeToolId[0]) && this.flush) {\r\n            this.points.push({ x: this.previousPosition.x, y: this.previousPosition.y });\r\n            this.#createCurve();\r\n            this.flush = false;\r\n        }\r\n\r\n        if (flush !== undefined) this.flush = flush;\r\n\r\n        if (this.flush) {\r\n            if (['R', 'C'].includes(_toolbox_manager_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"].activeToolId[0])) this.points.push({ x: this.previousPosition.x, y: this.previousPosition.y });\r\n\r\n            _layer_manager_js__WEBPACK_IMPORTED_MODULE_5__[\"default\"].saveDrawing(this.path, this.points)\r\n\r\n            this.#reset()\r\n        }\r\n\r\n        this.flush = true;\r\n    }\r\n\r\n    releasePath() {\r\n        if ((['L',].includes(_toolbox_manager_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"].activeToolId[0]) && this.points.length < 2) || (['P', 'K'].includes(_toolbox_manager_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"].activeToolId[0]) && this.points.length < 3)) return this.#reset();\r\n        this.#flushDrawing(true);\r\n    }\r\n\r\n    #clear() {\r\n        this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\r\n    }\r\n\r\n    #moveToInitialPosition() {\r\n        if (!this.points.length) this.points.push({ x: this.initialPosition.x, y: this.initialPosition.y });\r\n        this.#clear();\r\n        this.createPath();\r\n        this.ctx.moveTo(this.initialPosition.x, this.initialPosition.y)\r\n        this.path.moveTo(this.initialPosition.x, this.initialPosition.y);\r\n    }\r\n\r\n    #moveToPreviousPosition() {\r\n        if (_app_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"].state.fill || _app_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"].state.clip) {\r\n            this.ctx.lineTo(this.previousPosition.x, this.previousPosition.y);\r\n            this.path?.lineTo?.(this.previousPosition.x, this.previousPosition.y);\r\n        } else {\r\n            this.ctx.moveTo(this.previousPosition.x, this.previousPosition.y);\r\n            this.path?.moveTo?.(this.previousPosition.x, this.previousPosition.y);\r\n        }\r\n    }\r\n\r\n    #createCurve() {\r\n        if (_toolbox_manager_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"].activeToolId === 'K-bezier') {\r\n            this.points.push({ x: this.previousPosition.x, y: this.previousPosition.y });\r\n            this.points.push({ x: this.previousPosition.x, y: this.previousPosition.y });\r\n        }\r\n\r\n        console.log(this.points.length);\r\n    }\r\n\r\n    #computeHandle(p, pPrev, pNext) {\r\n        console.log(p, pPrev, pNext);\r\n        if (!(p && pPrev && pNext)) return;\r\n\r\n        const { ux, uy } = (0,_utils_vector_js__WEBPACK_IMPORTED_MODULE_2__.calculateTangent)(pPrev, pNext);\r\n        const k = 0.25;\r\n\r\n        const lenPrev = Math.hypot(p.x - pPrev.x, p.y - pPrev.y);\r\n        const lenNext = Math.hypot(p.x - pNext.x, p.y - pNext.y);\r\n\r\n        const len = k * Math.min(lenPrev, lenNext);\r\n\r\n        return { prev: { x: p.x - ux * len, y: p.y - uy * len }, next: { x: p.x + ux * len, y: p.y + uy * len } };\r\n    }\r\n\r\n    #drawline() {\r\n        this.#clear();\r\n        this.createPath()\r\n        if (this.points.length) {\r\n            this.ctx.moveTo(this.points[0].x, this.points[0].y);\r\n            this.path.moveTo(this.points[0].x, this.points[0].y);\r\n        } else {\r\n            this.#createCurve();\r\n            this.#moveToInitialPosition();\r\n        }\r\n    }\r\n\r\n    draw(x, y) {\r\n        const state = _app_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"].state;\r\n        const activeTool = _toolbox_manager_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"].activeToolId;\r\n\r\n        const drawGPath = ['P', 'L', 'K'].includes(activeTool[0]);\r\n        if (drawGPath)\r\n            this.ctx.beginPath();\r\n        if (!state.erase) {\r\n            switch (activeTool) {\r\n                case 'P-pen':\r\n                    this.#pen(x, y);\r\n                    break;\r\n                case 'P-chalk':\r\n                    this.#chalk(x, y);\r\n                    break;\r\n                case 'R-rectangle':\r\n                    this.#rectangle(x, y);\r\n                    break;\r\n                case 'R-roundrectangle':\r\n                    this.#roundRectangle(x, y);\r\n                    break;\r\n                case 'C-circle':\r\n                    this.#circle(x, y);\r\n                    break;\r\n                case 'C-ellipse':\r\n                    this.#ellipse(x, y);\r\n                    break;\r\n                case 'L-line':\r\n                    this.#line(x, y);\r\n                    break;\r\n                case 'L-arcto':\r\n                    this.#arcTo(x, y);\r\n                    break;\r\n                case 'K-bezier':\r\n                    this.#bezier(x, y);\r\n                    break;\r\n                case 'K-quadratic':\r\n                    this.#quadratic(x, y);\r\n                    break;\r\n                default:\r\n                    this.#eraser(x, y);\r\n                    break;\r\n            }\r\n\r\n            // this.ctx.fillStyle = 'red';\r\n            // this.ctx.strokeStyle = 'yellow';\r\n\r\n\r\n\r\n            if (state.fill && !drawGPath) {\r\n                this.ctx.fill(this.path);\r\n            }\r\n            if (drawGPath)\r\n                this.ctx.stroke();\r\n            else\r\n                this.ctx.stroke(this.path);\r\n\r\n            if (activeTool[0] === 'P') {\r\n                this.points.push({ x, y });\r\n            }\r\n\r\n            // if (state.clip) {\r\n            //     this.ctx.clip(this.path);\r\n            // }\r\n        } else {\r\n            this.#eraser(x, y);\r\n            this.points.push({ x, y });\r\n        }\r\n    }\r\n\r\n    #pen(x, y) {\r\n        this.#moveToPreviousPosition();\r\n        this.ctx.lineTo(x, y);\r\n        this.path.lineTo(x, y);\r\n    }\r\n\r\n    #chalk(x, y) {\r\n        this.#moveToPreviousPosition();\r\n        const path = this.path;\r\n        const tangent = (0,_utils_vector_js__WEBPACK_IMPORTED_MODULE_2__.calculateTangent)({ x, y }, this.previousPosition);\r\n        // const normal = calculateNormal(tangent);\r\n        const stepDX = tangent.ux;\r\n        const stepDY = tangent.uy;\r\n        const randomNess = 1;\r\n        const density = 1;\r\n        const pebbleSize = 0.1;\r\n\r\n        for (let i = 0; i < Math.floor(tangent.L); i++) {\r\n            for (let j = 0; j < density; j++) {\r\n                const xs = (x + (stepDX * i)) + (0,_utils_random_js__WEBPACK_IMPORTED_MODULE_1__.random)(-randomNess, randomNess);\r\n                const ys = (y + (stepDY * i)) + (0,_utils_random_js__WEBPACK_IMPORTED_MODULE_1__.random)(-randomNess, randomNess);\r\n\r\n                if (!_app_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"].state.fill) {\r\n                    path.moveTo(xs, ys);\r\n                }\r\n                this.ctx.moveTo(xs, ys);\r\n                this.ctx.arc(xs, ys, pebbleSize, 0, Math.PI * 2);\r\n                path.arc(xs, ys, pebbleSize, 0, Math.PI * 2);\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    #rectangle(x, y) {\r\n        this.#moveToInitialPosition();\r\n        this.path.rect(this.initialPosition.x, this.initialPosition.y, x - this.initialPosition.x, y - this.initialPosition.y);\r\n    }\r\n\r\n    #roundRectangle(x, y) {\r\n        this.#moveToInitialPosition();\r\n        this.path.roundRect(this.initialPosition.x, this.initialPosition.y, x - this.initialPosition.x, y - this.initialPosition.y, 10);\r\n    }\r\n\r\n    #circle(x, y) {\r\n        this.#clear();\r\n        this.createPath()\r\n        const radius = Math.hypot(x - this.initialPosition.x, y - this.initialPosition.y);\r\n        this.path?.arc?.(this.initialPosition.x, this.initialPosition.y, radius, 0, Math.PI * 2);\r\n        if (!this.points.length) this.points.push({ x: this.initialPosition.x, y: this.initialPosition.y });\r\n    }\r\n    #ellipse(x, y) {\r\n        this.#clear();\r\n        this.createPath()\r\n        const radiusX = Math.abs(x - this.initialPosition.x);\r\n        const radiusY = Math.abs(y - this.initialPosition.y);\r\n        // const rotation = Math.atan2(y - this.initialPosition.y, x - this.initialPosition.x);\r\n        this.path?.ellipse?.(this.initialPosition.x, this.initialPosition.y, radiusX, radiusY, 0, 0, Math.PI * 2);\r\n        if (!this.points.length) this.points.push({ x: this.initialPosition.x, y: this.initialPosition.y });\r\n    }\r\n\r\n    #line(x, y) {\r\n        this.#drawline();\r\n        this.points.forEach(({ x, y }) => {\r\n            this.ctx.lineTo(x, y);\r\n            this.path?.lineTo?.(x, y);\r\n        })\r\n        this.ctx.lineTo(x, y);\r\n        // this.path.lineTo(x, y);\r\n    }\r\n\r\n    #arcTo(x, y) {\r\n        this.#drawline();\r\n        const points = [...this.points, { x, y }];\r\n        const count = points.length - 1;\r\n        for (let i = 1; i < count; i++) {\r\n            const p = points[i - 1];\r\n            const cp = points[i];\r\n            const p2 = points[i + 1];\r\n            const radius = Math.hypot(p.x - cp.x, p.y - cp.y) / 4;\r\n            this.ctx.arcTo(cp.x, cp.y, p2.x, p2.y, radius);\r\n            this.path?.arcTo?.(cp.x, cp.y, p2.x, p2.y, radius);\r\n\r\n        }\r\n\r\n        this.ctx.lineTo(x, y);\r\n        // this.path?.lineTo?.(x, y);\r\n    }\r\n\r\n    #bezier(x, y) {\r\n        console.clear();\r\n        this.#drawline();\r\n        const count = this.points.length;\r\n        this.points[count - 1] = { x, y }\r\n\r\n        const handle = this.#computeHandle(this.points?.[count - 3], this.points?.[count - 6], { x, y });\r\n\r\n        if (handle) {\r\n            const { prev, next } = handle;\r\n            console.log('handle')\r\n            this.points[count - 4] = prev;\r\n            this.points[count - 2] = next;\r\n        }\r\n\r\n        const path = this.points;\r\n\r\n        for (let i = 1; i < count - 2; i += 3) {\r\n            const cp1 = path[i];\r\n            const cp2 = path[i + 1];\r\n            const p = path[i + 2];\r\n            this.ctx.bezierCurveTo?.(cp1.x, cp1.y, cp2.x, cp2.y, p.x, p.y);\r\n            this.path?.bezierCurveTo?.(cp1.x, cp1.y, cp2.x, cp2.y, p.x, p.y);\r\n            // this.ctx.circle(cp1.x, cp1.y - 10, 'red', `${i} C1 ${Math.round(cp1.x)} ${Math.round(cp1.y)}`);\r\n            // this.ctx.circle(cp2.x, cp2.y - 20, 'green', `${i} C2 ${Math.round(cp2.x)} ${Math.round(cp2.y)}`);\r\n            // this.ctx.circle(p.x, p.y, 'blue', `${i} P ${Math.round(p.x)} ${Math.round(p.y)}`);\r\n        }\r\n\r\n        this.ctx.bezierCurveTo?.(path[count - 2].x, path[count - 2].y, path[count - 1].x, path[count - 1].y, x, y);\r\n\r\n        // this.ctx.circle(path[0].x, path[0].y, 'black', `P ${Math.round(path[0].x)} ${Math.round(path[0].y)}`);\r\n        // this.ctx.circle(path[count - 2].x, path[count - 2].y - 10, 'cyan', `C1 ${Math.round(path[count - 2].x)} ${Math.round(path[count - 2].y)}`);\r\n        // this.ctx.circle(path[count - 1].x, path[count - 1].y - 20, 'magenta', `C2 ${Math.round(path[count - 1].x)} ${Math.round(path[count - 1].y)}`);\r\n        // this.ctx.circle(x, y, 'yellow', `P ${Math.round(x)} ${Math.round(y)}`);\r\n    }\r\n\r\n    #quadratic(x, y) {\r\n        this.#drawline();\r\n        const path = this.points;\r\n        const count = path.length - 1;\r\n        for (let i = 1; i < count; i += 2) {\r\n            const p = path[i + 1];\r\n            const cp = path[i];\r\n            this.ctx.quadraticCurveTo?.(cp.x, cp.y, p.x, p.y);\r\n            this.path?.quadraticCurveTo?.(cp.x, cp.y, p.x, p.y);\r\n            this.ctx.circle(p.x, p.y, p.cp ? 'purple' : 'maroon')\r\n        }\r\n\r\n        this.ctx.quadraticCurveTo?.(path[count].x, path[count].y, x, y);\r\n    }\r\n\r\n\r\n    #eraser(x, y) {\r\n        const layer = _layer_manager_js__WEBPACK_IMPORTED_MODULE_5__[\"default\"].getActiveLayer();\r\n        const dX = this.previousPosition.x - x;\r\n        const dY = this.previousPosition.y - y;\r\n        const radius = Math.hypot(dX, dY);\r\n        if (radius <= 0) {\r\n            layer?.ctx?.clearRect?.(x, y, 5, 5);\r\n            return;\r\n        }\r\n\r\n        const stepDX = dX / radius;\r\n        const stepDY = dY / radius;\r\n        for (let i = 0; i < Math.floor(radius); i++) {\r\n            const xs = (x + (stepDX * i));\r\n            const ys = (y + (stepDY * i));\r\n            layer?.ctx?.clearRect?.(xs, ys, 5, 5);\r\n        }\r\n    }\r\n}\r\n\r\nconst canvas = new Canvas();\r\n\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (canvas);\n\n//# sourceURL=webpack://quanvas/./scripts/core/canvas/canvas.js?\n}");

/***/ }),

/***/ "./scripts/core/canvas/layer/layer.js":
/*!********************************************!*\
  !*** ./scripts/core/canvas/layer/layer.js ***!
  \********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ Layer)\n/* harmony export */ });\n/* harmony import */ var _shared_domElem_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../shared/domElem.js */ \"./scripts/shared/domElem.js\");\n/* harmony import */ var _app_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../app.js */ \"./scripts/core/app.js\");\n\r\n\r\n\r\nclass Layer {\r\n    constructor(id, layerElem) {\r\n        const { width, height } = _shared_domElem_js__WEBPACK_IMPORTED_MODULE_0__.rootElem.getBoundingClientRect();\r\n        const { width: lWidth, height: lHeight } = layerElem.getBoundingClientRect();\r\n\r\n        this.previousPosition = { x: 0, y: 0 };\r\n        this.initialPosition = { x: 0, y: 0 };\r\n\r\n        this.canvas = document.createElement('canvas');\r\n\r\n        this.layerCanvas = this.canvas.cloneNode();\r\n        this.canvas.dataset.id = id.unique;\r\n\r\n        _shared_domElem_js__WEBPACK_IMPORTED_MODULE_0__.rootElem.appendChild(this.canvas);\r\n        layerElem.appendChild(this.layerCanvas);\r\n\r\n        this.layer = layerElem;\r\n\r\n        this.ctx = this.canvas.getContext('2d');\r\n        this.lctx = this.layerCanvas.getContext('2d');\r\n\r\n\r\n        this.canvas.width = width;\r\n        this.canvas.height = height;\r\n        this.layerCanvas.width = lWidth;\r\n        this.layerCanvas.height = lHeight;\r\n\r\n        const span = document.createElement('span');\r\n        span.innerText = `Layer ${id.name}`;\r\n\r\n        layerElem.appendChild(span);\r\n        this.id = id.unique;\r\n        this.name = id.name;\r\n        this.isDrawing = false;\r\n        this.data = new Set();\r\n    }\r\n\r\n    drawPath(path, fill) {\r\n        if (_app_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].state.clip) {\r\n            this.ctx.clip(path);\r\n            if (!fill) this.ctx.stroke(path);\r\n        } else {\r\n            if (fill) {\r\n                this.ctx.fill(path);\r\n            }\r\n            this.ctx.stroke(path);\r\n        }\r\n\r\n        this.lctx.clearRect(0, 0, this.layerCanvas.width, this.layerCanvas.height);\r\n        this.lctx.drawImage(this.canvas, 0, 0, this.layerCanvas.width, this.layerCanvas.height);\r\n    }\r\n\r\n    addData(data) {\r\n        this.data.add(data);\r\n    }\r\n}\n\n//# sourceURL=webpack://quanvas/./scripts/core/canvas/layer/layer.js?\n}");

/***/ }),

/***/ "./scripts/core/canvas/layer/manager.js":
/*!**********************************************!*\
  !*** ./scripts/core/canvas/layer/manager.js ***!
  \**********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _layer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./layer.js */ \"./scripts/core/canvas/layer/layer.js\");\n/* harmony import */ var _shared_domElem_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../shared/domElem.js */ \"./scripts/shared/domElem.js\");\n/* harmony import */ var _app_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../app.js */ \"./scripts/core/app.js\");\n/* harmony import */ var _toolbox_manager_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../toolbox/manager.js */ \"./scripts/core/toolbox/manager.js\");\n/* harmony import */ var _serialization_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./serialization.js */ \"./scripts/core/canvas/layer/serialization.js\");\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! uuid */ \"./node_modules/uuid/dist/v4.js\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst layersElem = document.getElementById('layers');\r\nconst addLayerElem = document.getElementById('addlayer');\r\n\r\n\r\nclass LayerManager {\r\n    constructor() {\r\n        this.layer = new Map();\r\n        this.activeLayerId = null;\r\n        this.#addEventListener();\r\n    }\r\n\r\n    #addEventListener() {\r\n        addLayerElem.addEventListener('click', _ => {\r\n            this.createLayer();\r\n        })\r\n\r\n        layersElem.addEventListener('dragstart', (e) => {\r\n            const layer = e.target.closest('.layer');\r\n            if (!layer) return;\r\n            layer.classList.add('dragging');\r\n        });\r\n\r\n        layersElem.addEventListener('dragend', (e) => {\r\n            const layer = e.target.closest('.layer');\r\n            if (!layer) return;\r\n            layer.classList.remove('dragging');\r\n        });\r\n\r\n        layersElem.addEventListener(\"dragover\", (e) => {\r\n            e.preventDefault();\r\n            const afterElement = this.#getDragAfterElement(e.clientY);\r\n            const draggable = layersElem.querySelector(\".dragging\");\r\n            if (!draggable) return;\r\n            if (afterElement == null) {\r\n                const dCanvas = this.layer.get(draggable.dataset.id);\r\n                layersElem.appendChild(dCanvas.layer);\r\n                _shared_domElem_js__WEBPACK_IMPORTED_MODULE_1__.rootElem.appendChild(dCanvas.canvas);\r\n            } else {\r\n                const dCanvas = this.layer.get(draggable.dataset.id);\r\n                const aCanvas = this.layer.get(afterElement.dataset.id);\r\n                layersElem.insertBefore(dCanvas.layer, aCanvas.layer);\r\n                _shared_domElem_js__WEBPACK_IMPORTED_MODULE_1__.rootElem.insertBefore(dCanvas.canvas, aCanvas.canvas);\r\n            }\r\n        });\r\n\r\n    }\r\n\r\n    createLayer() {\r\n        const id = {\r\n            unique: (0,uuid__WEBPACK_IMPORTED_MODULE_5__[\"default\"])(),\r\n            name: this.layer.size + 1\r\n        }\r\n        const layer = document.createElement('div');\r\n        layer.classList.add('layer');\r\n        layer.draggable = true;\r\n        layer.dataset.id = id.unique;\r\n        layersElem.prepend(layer);\r\n        this.layer.set(id.unique, new _layer_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"](id, layer));\r\n\r\n        layer.addEventListener('click', e => {\r\n            this.setActiveLayer(e.currentTarget.dataset.id);\r\n        });\r\n\r\n        this.setActiveLayer(id.unique);\r\n    }\r\n\r\n    getLayer(id) {\r\n        return this.layer.get(id);\r\n    }\r\n\r\n    getActiveLayer() {\r\n        return this.getLayer(this.activeLayerId);\r\n    }\r\n\r\n    saveDrawing(path, points) {\r\n        console.clear();\r\n        const layer = this.getActiveLayer();\r\n\r\n        const data = _serialization_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"].serialize({\r\n            points,\r\n            state: _app_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"].state,\r\n            tool: _toolbox_manager_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"].activeToolId,\r\n            layer: layer.id\r\n        })\r\n\r\n        layer.drawPath(path, _app_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"].state.fill);\r\n\r\n        layer.addData(data);\r\n\r\n        console.table(points)\r\n        console.log('Total points:', points.length);\r\n    }\r\n\r\n    setActiveLayer(id) {\r\n        const layer = this.layer.get(this.activeLayerId);\r\n        layer?.layer?.classList?.remove('selectedLayer');\r\n\r\n        const newLayer = this.layer.get(id)\r\n        newLayer?.layer?.classList?.add('selectedLayer');\r\n\r\n        this.activeLayerId = id;\r\n    }\r\n\r\n    renameLayer(id, name) {\r\n\r\n    }\r\n\r\n    removeLayer(id) {\r\n\r\n    }\r\n\r\n    moveLayer(id, toindex) {\r\n\r\n    }\r\n\r\n    mergeLayer(topLayerId, bottomLayerId) {\r\n\r\n    }\r\n\r\n    addPathToLayer(id, path) {\r\n\r\n    }\r\n\r\n    clearLayer(id) {\r\n\r\n    }\r\n\r\n    getState() {\r\n\r\n    }\r\n\r\n    loadState(state) {\r\n\r\n    }\r\n\r\n    clearAll() {\r\n        this.layers = [];\r\n        this.activeLayerId = null;\r\n    }\r\n\r\n    #getDragAfterElement(y) {\r\n        const elements = Array.from(layersElem.querySelectorAll('.layer:not(.dragging)'));\r\n        return elements.reduce(\r\n            (closest, child) => {\r\n                const box = child.getBoundingClientRect();\r\n                const offset = y - box.top - box.height / 2;\r\n                if (offset < 0 && offset > closest.offset) {\r\n                    return { offset: offset, element: child };\r\n                } else {\r\n                    return closest;\r\n                }\r\n            },\r\n            { offset: Number.NEGATIVE_INFINITY }\r\n        ).element;\r\n    }\r\n}\r\n\r\nconst layerManager = new LayerManager();\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (layerManager);\n\n//# sourceURL=webpack://quanvas/./scripts/core/canvas/layer/manager.js?\n}");

/***/ }),

/***/ "./scripts/core/canvas/layer/serialization.js":
/*!****************************************************!*\
  !*** ./scripts/core/canvas/layer/serialization.js ***!
  \****************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ Serializer)\n/* harmony export */ });\nclass Serializer {\r\n    constructor() {\r\n\r\n    }\r\n\r\n    static serialize(data) {\r\n        const points = data.points;\r\n        const buffer = new ArrayBuffer(8 * points.length);\r\n\r\n        const view = new Float32Array(buffer);\r\n        for (let i = 0; i < points.length; i += 2) {\r\n            view[i] = points[i].x;\r\n            view[i + 1] = points[i].y;\r\n        }\r\n\r\n        return {\r\n            ...data,\r\n            points: buffer\r\n        }\r\n    }\r\n\r\n    static unserialize() {\r\n\r\n    }\r\n}\n\n//# sourceURL=webpack://quanvas/./scripts/core/canvas/layer/serialization.js?\n}");

/***/ }),

/***/ "./scripts/core/toolbox/manager.js":
/*!*****************************************!*\
  !*** ./scripts/core/toolbox/manager.js ***!
  \*****************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _shared_constants_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../shared/constants.js */ \"./scripts/shared/constants.js\");\n/* harmony import */ var _canvas_canvas_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../canvas/canvas.js */ \"./scripts/core/canvas/canvas.js\");\n\r\n\r\n\r\nconst sideBarMenuElem = document.getElementById(\"tools\");\r\nconst toolsMenuElem = document.getElementById('toolsmenu');\r\n\r\nclass ToolBoxManager {\r\n    constructor() {\r\n        ('Tool Manager')\r\n        this.activeToolId = 'P-pen';\r\n        this.#addEventListener();\r\n    }\r\n\r\n    #addEventListener() {\r\n        sideBarMenuElem.addEventListener(\"click\", (e) => {\r\n            toolsMenuElem.style.visibility = 'hidden';\r\n            const tool = e.target;\r\n            if (!_shared_constants_js__WEBPACK_IMPORTED_MODULE_0__.TOOLS_MENU[tool.id[0]]?.includes(tool.id)) return;\r\n            const prevM = toolsMenuElem.querySelector(`#${this.activeToolId[0]}`);\r\n            const newM = toolsMenuElem.querySelector(`#${tool.id[0]}`);\r\n            prevM.style.display = 'none';\r\n            newM.style.display = 'flex';\r\n            if (e.ctrlKey && _shared_constants_js__WEBPACK_IMPORTED_MODULE_0__.TOOLS_MENU[tool.id[0]].length > 1) {\r\n                const { top, right } = tool.getBoundingClientRect();\r\n                toolsMenuElem.style.top = top + 'px';\r\n                toolsMenuElem.style.left = (right + 10) + 'px';\r\n                toolsMenuElem.style.visibility = 'visible';\r\n            }\r\n            this.selectTool(tool.id);\r\n        });\r\n\r\n        toolsMenuElem.addEventListener('click', (e) => {\r\n            toolsMenuElem.style.visibility = 'hidden';\r\n            if (!_shared_constants_js__WEBPACK_IMPORTED_MODULE_0__.TOOLS_MENU[e.target.id[0]]?.includes(e.target.id)) return;\r\n            this.selectTool(e.target.id);\r\n        })\r\n    }\r\n\r\n    selectTool(id) {\r\n        _canvas_canvas_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].releasePath();\r\n        let elem;\r\n        const toolsMenu = _shared_constants_js__WEBPACK_IMPORTED_MODULE_0__.TOOLS_MENU[id[0]];\r\n\r\n        for (let i = 0; i < toolsMenu.length; i++) {\r\n            if (toolsMenu[i] == id) {\r\n                elem = document.getElementById(id);\r\n                break;\r\n            };\r\n        }\r\n\r\n        sideBarMenuElem.querySelector(`#${this.activeToolId}`).classList.remove('selected');\r\n        let selectedElem = sideBarMenuElem.querySelector(`#${elem.id}`);\r\n        if (!selectedElem) {\r\n            selectedElem = sideBarMenuElem.querySelector(`[id^=${elem.id[0]}]`);\r\n            const tempSrc = elem.src;\r\n            const tempId = elem.id;\r\n            elem.src = selectedElem.src;\r\n            elem.id = selectedElem.id;\r\n            selectedElem.src = tempSrc;\r\n            selectedElem.id = tempId;\r\n            selectedElem.classList.add('selected');\r\n        } else {\r\n            selectedElem = elem;\r\n        }\r\n        selectedElem.classList.add('selected');\r\n\r\n        this.activeToolId = selectedElem.id;\r\n    }\r\n}\r\n\r\nconst toolsManager = new ToolBoxManager();\r\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (toolsManager);\n\n//# sourceURL=webpack://quanvas/./scripts/core/toolbox/manager.js?\n}");

/***/ }),

/***/ "./scripts/shared/constants.js":
/*!*************************************!*\
  !*** ./scripts/shared/constants.js ***!
  \*************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   TOOLS_MENU: () => (/* binding */ TOOLS_MENU),\n/* harmony export */   TOOL_IDS: () => (/* binding */ TOOL_IDS)\n/* harmony export */ });\nconst TOOL_IDS = [\r\n    'pen', 'pen',\r\n    'rectangle', 'round-rectangle',\r\n    'circle', 'ellipse',\r\n    'line',\r\n    'quadratic', 'bezier',\r\n    'add-layer',\r\n    'clipboard',\r\n    'eraser', 'fillrule',\r\n    'nomove'\r\n];\r\n\r\nconst TOOLS_MENU = {\r\n    'P': ['P-pen', 'P-chalk'],\r\n    'R': ['R-rectangle', 'R-roundrectangle'],\r\n    'C': ['C-circle', 'C-ellipse'],\r\n    'L': ['L-line', 'L-arcto'],\r\n    'K': ['K-quadratic', 'K-bezier'],\r\n};\r\n\n\n//# sourceURL=webpack://quanvas/./scripts/shared/constants.js?\n}");

/***/ }),

/***/ "./scripts/shared/domElem.js":
/*!***********************************!*\
  !*** ./scripts/shared/domElem.js ***!
  \***********************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   rootElem: () => (/* binding */ rootElem)\n/* harmony export */ });\nconst rootElem = document.getElementById('root');\n\n//# sourceURL=webpack://quanvas/./scripts/shared/domElem.js?\n}");

/***/ }),

/***/ "./scripts/utils/random.js":
/*!*********************************!*\
  !*** ./scripts/utils/random.js ***!
  \*********************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   lerp: () => (/* binding */ lerp),\n/* harmony export */   random: () => (/* binding */ random)\n/* harmony export */ });\nfunction random(min, max) {\r\n    const minCeiled = Math.ceil(min);\r\n    const maxFloored = Math.floor(max);\r\n    return Math.floor(Math.random() * (maxFloored - minCeiled) + minCeiled);\r\n}\r\n\r\nfunction lerp(a, b, t) {\r\n    return a + (b - a) * t;\r\n}\n\n//# sourceURL=webpack://quanvas/./scripts/utils/random.js?\n}");

/***/ }),

/***/ "./scripts/utils/vector.js":
/*!*********************************!*\
  !*** ./scripts/utils/vector.js ***!
  \*********************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   calculateNormal: () => (/* binding */ calculateNormal),\n/* harmony export */   calculateTangent: () => (/* binding */ calculateTangent),\n/* harmony export */   getNormal: () => (/* binding */ getNormal)\n/* harmony export */ });\nfunction getNormal(c1, c2) {\r\n    const tangent = calculateTangent(c1, c2);\r\n    return calculateNormal(tangent);\r\n}\r\n\r\nfunction calculateTangent(a, b) {\r\n    const x = b.x - a.x;\r\n    const y = b.y - a.y;\r\n\r\n    const L = Math.hypot(x, y);\r\n\r\n    return {\r\n        x,\r\n        y,\r\n        L,\r\n        ux: x / L,\r\n        uy: y / L\r\n    }\r\n}\r\n\r\nfunction calculateNormal(tangent) {\r\n    const { x: Tx, y: Ty, ux: Tux, uy: Tuy } = tangent;\r\n\r\n    return {\r\n        x: -Ty,\r\n        y: Tx,\r\n        ux: -Tuy,\r\n        uy: Tux\r\n    }\r\n}\n\n//# sourceURL=webpack://quanvas/./scripts/utils/vector.js?\n}");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module can't be inlined because the eval devtool is used.
/******/ 	var __webpack_exports__ = __webpack_require__("./main.js");
/******/ 	
/******/ })()
;